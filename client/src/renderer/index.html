<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>R/Drive</title>
    <% if (htmlWebpackPlugin.options.isProd) { %>
    <meta
      http-equiv="Content-Security-Policy"
      content="
        default-src 'self' blob: data:;
        script-src 'self';
        style-src 'self';
        img-src 'self' blob: data:;
        media-src 'self' blob: data:;
        connect-src 'self'
          http://localhost:4001
          https://cognito-idp.eu-north-1.amazonaws.com
          https://*.amazoncognito.com
          https://file-sync-bucket-1312414151515.s3.us-east-1.amazonaws.com;
      "
    />
    <% } else { %>
    <meta
      http-equiv="Content-Security-Policy"
      content="
        default-src 'self' blob: data:;
        script-src 'self' 'unsafe-inline';
        style-src 'self' 'unsafe-inline';
        img-src 'self' blob: data:;
        media-src 'self' blob: data:;
        connect-src *;
      "
    />
    <% } %>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body class="bg-gray-100 min-h-screen p-6">
    <main class="w-full max-w-4xl mx-auto">
      <!-- Header -->
      <header class="mb-8 text-center">
        <h1 class="text-3xl font-extrabold text-gray-800">üìÇ R/Drive</h1>
        <p class="text-gray-600">
          Store, preview, and manage your files securely
        </p>
      </header>

      <!-- Auth Forms -->
      <section id="authContainer" class="max-w-md mx-auto">
        <div class="bg-white rounded-xl shadow-md p-6 space-y-6">
          <!-- Login Form -->
          <form id="loginForm" class="flex flex-col gap-4">
            <h2 class="text-xl font-bold text-gray-700">Sign In</h2>
            <div>
              <label
                for="loginEmail"
                class="block text-sm font-medium text-gray-600"
                >Email</label
              >
              <input
                id="loginEmail"
                type="email"
                placeholder="you@example.com"
                class="w-full border px-3 py-2 rounded mt-1 focus:ring-2 focus:ring-blue-500"
              />
            </div>
            <div>
              <label
                for="loginPassword"
                class="block text-sm font-medium text-gray-600"
                >Password</label
              >
              <input
                id="loginPassword"
                type="password"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                class="w-full border px-3 py-2 rounded mt-1 focus:ring-2 focus:ring-blue-500"
              />
            </div>
            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"
            >
              Sign In
            </button>
            <button
              type="button"
              id="showSignUp"
              class="text-sm text-blue-600 hover:underline self-start"
            >
              Create an account
            </button>
          </form>

          <!-- Signup Form -->
          <form id="signupForm" class="hidden flex flex-col gap-4">
            <h2 class="text-xl font-bold text-gray-700">Sign Up</h2>
            <div>
              <label
                for="signupName"
                class="block text-sm font-medium text-gray-600"
                >Name</label
              >
              <input
                id="signupName"
                type="text"
                placeholder="John Doe"
                class="w-full border px-3 py-2 rounded mt-1 focus:ring-2 focus:ring-green-500"
              />
            </div>
            <div>
              <label
                for="signupEmail"
                class="block text-sm font-medium text-gray-600"
                >Email</label
              >
              <input
                id="signupEmail"
                type="email"
                placeholder="you@example.com"
                class="w-full border px-3 py-2 rounded mt-1 focus:ring-2 focus:ring-green-500"
              />
            </div>
            <div>
              <label
                for="signupPassword"
                class="block text-sm font-medium text-gray-600"
                >Password</label
              >
              <input
                id="signupPassword"
                type="password"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                class="w-full border px-3 py-2 rounded mt-1 focus:ring-2 focus:ring-green-500"
              />
            </div>
            <button
              type="submit"
              class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition"
            >
              Sign Up
            </button>
            <button
              type="button"
              id="showSignIn"
              class="text-sm text-blue-600 hover:underline self-start"
            >
              Back to Sign In
            </button>
          </form>

        <!-- Confirm Form -->
        <form id="confirmForm" class="hidden flex flex-col gap-2">
          <input
            id="confirmEmail"
            type="email"
            placeholder="Email"
            class="border px-3 py-2 rounded"
          />
          <input
            id="confirmCode"
            type="text"
            placeholder="Confirmation Code"
            class="border px-3 py-2 rounded"
          />
          <button
            type="submit"
            class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600"
          >
            Confirm
          </button>
          <button
            type="button"
            id="showSignInFromConfirm"
            class="text-sm underline mt-1"
          >
            Back to Sign In
          </button>
        </form>
        </div>
      </section>

      <!-- Authorized content -->
      <div id="appContainer" class="hidden mt-6">
        <!-- Top Toolbar -->
        <div class="flex justify-between items-center mb-4">
          <div class="flex items-center gap-2">
            <select
              id="filterSelect"
              class="bg-white border px-3 py-2 rounded text-sm shadow-sm"
            >
              <option value="all">All Files</option>
              <option value=".java">.java Files</option>
              <option value=".png">.png Files</option>
              <option value=".jpg">.jpg Files</option>
            </select>
            <button
              id="refreshButton"
              class="bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700 text-sm"
            >
              Refresh
            </button>
            <button
              id="uploadButton"
              class="bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 text-sm"
            >
              + Upload
            </button>
            <div class="flex items-center space-x-3">
              <button
                id="syncFolderBtn"
                class="bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 text-sm"
              >
                Sync Folder
              </button>
              <span
                id="syncFolderPath"
                class="text-gray-700 text-sm truncate max-w-xs"
                >No folder selected</span
              >
            </div>

            <div class="relative inline-block">
              <!-- Column settings button -->
              <button
                id="columnMenuBtn"
                class="bg-gray-200 px-2 py-1 rounded hover:bg-gray-300 text-sm"
                title="Edit Columns"
              >
                ‚úèÔ∏è
              </button>

              <!-- Column menu (hidden by default) -->
              <div
                id="columnMenu"
                class="hidden absolute mt-2 right-0 bg-white rounded shadow-lg border p-3 text-sm z-50 w-56"
              >
                <div class="font-semibold mb-2">Toggle Columns</div>
                <label class="block"
                  ><input
                    type="checkbox"
                    class="col-toggle"
                    data-col="size"
                    checked
                  />
                  <span class="ml-2">Size</span></label
                >
                <label class="block"
                  ><input
                    type="checkbox"
                    class="col-toggle"
                    data-col="createdAt"
                    checked
                  />
                  <span class="ml-2">Created At</span></label
                >
                <label class="block"
                  ><input
                    type="checkbox"
                    class="col-toggle"
                    data-col="updatedAt"
                    checked
                  />
                  <span class="ml-2">Updated At</span></label
                >
                <label class="block"
                  ><input
                    type="checkbox"
                    class="col-toggle"
                    data-col="createdBy"
                    checked
                  />
                  <span class="ml-2">Created by</span></label
                >
                <label class="block"
                  ><input
                    type="checkbox"
                    class="col-toggle"
                    data-col="updatedBy"
                    checked
                  />
                  <span class="ml-2">Updated by</span></label
                >
              </div>
            </div>
          </div>

          <div class="relative">
            <button
              id="profileBtn"
              class="flex items-center gap-2 bg-white border px-3 py-2 rounded shadow-sm hover:bg-gray-50"
            >
              <span id="userEmail" class="text-gray-700 text-sm"></span>
              <svg
                class="w-4 h-4 text-gray-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </button>
            <div
              id="profileMenu"
              class="hidden absolute right-0 mt-2 bg-white rounded shadow-lg w-40 border"
            >
              <button
                id="logoutBtn"
                class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
              >
                Logout
              </button>
            </div>
          </div>
        </div>

        <!-- Preview Modal -->
        <div
          id="previewModal"
          class="hidden fixed inset-0 bg-white/30 backdrop-blur-sm flex justify-center items-center z-50"
        >
          <div
            class="bg-white rounded-lg p-4 max-w-3xl w-full relative shadow-lg"
          >
            <button
              id="closePreview"
              class="absolute top-2 right-2 text-gray-600 hover:text-gray-900"
            >
              &times;
            </button>
            <h2 id="previewTitle" class="text-lg font-bold mb-2"></h2>
            <div id="previewContent" class="overflow-auto max-h-[70vh]"></div>
          </div>
        </div>

        <!-- File Table -->
        <div id="app">
          <!-- <div class="overflow-hidden rounded-lg shadow"> -->
          <div class="overflow-x-auto rounded-lg shadow"></div>
            <table
              id="fileTable"
              class="table-auto w-full text-sm text-left border"
            >
              <thead class="bg-gray-200 text-gray-700 uppercase text-xs">
                <tr>
                  <th
                    data-sort="fileName"
                    data-col="fileName"
                    class="sortable px-6 py-3 cursor-pointer relative"
                  >
                    Name <span class="sort-arrow absolute right-2"></span>
                  </th>
                  <th
                    data-sort="size"
                    data-col="size"
                    class="sortable px-6 py-3 cursor-pointer relative"
                  >
                    Size <span class="sort-arrow absolute right-2"></span>
                  </th>
                  <th
                    data-sort="createdAt"
                    data-col="createdAt"
                    class="sortable px-6 py-3 cursor-pointer relative"
                  >
                    Created At<span class="sort-arrow absolute right-2"></span>
                  </th>
                  <th
                    data-sort="updatedAt"
                    data-col="updatedAt"
                    class="sortable px-6 py-3 cursor-pointer relative"
                  >
                    Updated At<span class="sort-arrow absolute right-2"></span>
                  </th>
                  <th
                    data-col="createdBy"
                    class="sortable px-6 py-3 cursor-pointer relative"
                  >
                    Created By
                  </th>
                  <th
                    data-col="updatedBy"
                    class="sortable px-6 py-3 cursor-pointer relative"
                  >
                    Updated By
                  </th>
                  <th class="px-6 py-3">Actions</th>
                </tr>
              </thead>
              <tbody
                id="fileTableBody"
                class="divide-y divide-gray-200"
              ></tbody>
            </table>
          </div>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
